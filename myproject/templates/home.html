{% extends "base.html" %}
{% block content %}

<br>
<br>
<div class="container-fluid top-container" style="max-width: 1000px;">
  <div class="medium-text">
    <!-- <div class="light-text">
      <h3 class="center-text">Crypto Portfolio</h3>
      <br>
      <br>
      {% if total_investment %}
          <h5 class="align-right">Total Portfolio Cost: {{ "${:,.2f}".format((total_investment)|round(2)) }}</h5>
      {% endif %}
      {% if total_portfolio_value %}
          <h5 class="align-right">Current Value: {{ "${:,.2f}".format((total_portfolio_value)|round(2)) }}</h5>
          {% if ((total_portfolio_value)|round(2)) - ((total_investment)|round(2)) < 0 %}
            <h5 class="align-right">Total Portfolio Profit: <span style="color: red;">{{ "${:,.2f}".format(((total_portfolio_value) - (total_investment))|round(2)) }}</span></h5>
          {% else %}
            <h5 class="align-right">Total Portfolio Profit: <span style="color: green;">{{ "${:,.2f}".format(((total_portfolio_value) - (total_investment))|round(2)) }}</span></h5>
          {% endif %}
      {% endif %}
    </div> -->
    <div class="light-text">
      <h3 class="center-text">Crypto Portfolio</h3>
      <p class="center-text">Add or Delete coins below to start tracking your profits</p>
      <br>
      <br>
    </div>
    <div class="row">
      <div class="col-3">

      </div>
      <div class="col-4">

      </div>
      <div class="col-5">
        <div class="my-table">
          <table class="table table-dark shadow-sm my-table">
            <tbody>
              {% if total_investment %}
              <tr>
                <th scope="row">Total Portfolio Cost:</th>
                <td>{{ "${:,.2f}".format((total_investment)|round(2)) }}</td>
              </tr>
              {% endif %}
              {% if total_portfolio_value %}
              <tr>
                <th scope="row">Current Value:</th>
                <td>{{ "${:,.2f}".format((total_portfolio_value)|round(2)) }}</td>
              </tr>
                {% if ((total_portfolio_value)|round(2)) - ((total_investment)|round(2)) < 0 %}
                <tr>
                  <th scope="row">Total Portfolio Profit:</th>
                  <td><span style="color: red;">{{ "${:,.2f}".format(((total_portfolio_value) - (total_investment))|round(2)) }}</span></td>
                </tr>
                {% else %}
                <tr>
                  <th scope="row">Total Portfolio Profit:</th>
                  <td><span style="color: green;">{{ "${:,.2f}".format(((total_portfolio_value) - (total_investment))|round(2)) }}</span></td>
                </tr>
                {% endif %}
              {% endif %}
            </tbody>
          </table>
        </div>
      </div>
    </div>






    <!-- Button trigger modal -->
  <button type="button" class="btn btn-add-help" data-toggle="modal" data-target="#exampleModal">
    Add Coin
  </button>

  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add Coin</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form class="" method="post">
            {{form1.hidden_tag()}}
            {{form1.symbol.label()}} {{form1.symbol()}}<br>
            {{form1.price_pur.label()}} {{form1.price_pur()}}<br>
            {{form1.amount.label()}} {{form1.amount()}}
            <div class="modal-footer">
              {{form1.submit1(class="btn btn-graph")}}
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>



  <!-- Button trigger modal -->
  <!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal2">
    Delete Coin
  </button> -->

  <!-- Modal -->
  <!-- <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Delete Coin</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form class="" method="post">
            {{form2.hidden_tag()}}
            {{form2.symbol.label()}} {{form2.symbol()}}
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              {{form2.submit2(class="btn btn-primary")}}
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> -->

<!-- Button trigger modal -->
<button type="button" class="btn btn-add-help" data-toggle="modal" data-target="#exampleModal3">
Need Help?
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal3" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
<div class="modal-dialog modal-lg">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Help using app</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
        <p>In this app you will be able to enter in the information regarding your crpto currency portfolio and get data back regarding your profits and losses. To add a crypto currency to your portfolio just click the "Add Coin" button. Once there you will input a coin symbol, average purchase price and the total amount owned. The coin symbol is like the ticker for stocks. In case you are not too familiar with crypto currencies some popular ones are BTC, ETH, XMR, XRP, LINK, LTC and ADA. Once all of the information is entered in the form you should see the coin pop up in your portfolio with data on your profits or losses. Feel free to add more coins and delete any you want to remove from the portfolio.</p>
        <img src="static/pics/help.png" alt="" style="height:60%;width:60%;">
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
    </div>
  </div>
</div>
</div>


  <div class="container-fluid bottom-container" style="max-width:1000px; padding:0px;">
    <br>
    <div class="my-table">
      <table class="table table-dark shadow-sm my-table">
        <thead>
          <tr>
            <th scope="col"></th>
            <th scope="col">Name</th>
            <th scope="col">Amount Owned</th>
            <th scope="col">Avg. Buy Price (USD)</th>
            <th scope="col">Current Price (USD)</th>
            <th scope="col">Profit</th>
          </tr>
        </thead>
        <tbody>
          {% for x in my_portfolio %}
            {% for y in api %}
              {% if x.coin == y['id'] %}


              <tr>
                <td><img src="{{y['logo_url']}}" class="img-fluid my-image2"></td>
                <td>{{y['name']}}, {{x.coin}} <br> <a href="{{url_for('delete', portfolio_coin_id=x.id)}}">Delete</a></td>
                <td>{{ "{:,.2f}".format(x.amount) }}</td>
                <td>{{ "${:,.2f}".format(x.price_pur) }}</td>
                <td>{{ "${:,.2f}".format(((y['price'])|float)|round(2)) }}</td>


                {% if (((x.amount*(y['price'])|float))-(x.amount*x.price_pur)) < 0 %}
                <td id="{{x.id}}" style="color: red;">{{ "${:,.2f}".format((((x.amount*(y['price'])|float))-(x.amount*x.price_pur))|round(2)) }}</td>
                {% else %}
                <td id="{{x.id}}" style="color: green;">{{ "${:,.2f}".format((((x.amount*(y['price'])|float))-(x.amount*x.price_pur))|round(2)) }}</td>
                {% endif %}
              </tr>



              {% endif %}
            {% endfor %}
          {% endfor %}
        </tbody>
      </table>
    </div>
    <br>
    <div class="d-flex justify-content-end">
      <a class="btn btn-clear" href="{{url_for('clear')}}">Clear All Coins</a>
    </div>
  </div>
  <br>
  <br>
  </div>
</div>


<!-- {% for x in my_portfolio %}
  {% for y in api %}
    {% if x.coin == y['id'] %}
      {% if (((x.amount*(y['price'])|float))-(x.amount*x.price_pur)) < 0 %}
        <style media="screen">
          #{{x.id}} {
            color : red;
          }
        </style>
        {% else %}
        <style media="screen">
          #{{x.id}} {
            color : green;
          }
        </style>
      {% endif %}
    {% endif %}
  {% endfor %}
{% endfor %} -->

<!-- <div class="jumbotron">
  <div class="container">
    <br>
    {% for x in my_portfolio %}
    <div class="row">
      {% for y in api %}
        {% if x.coin == y['id'] %}
            <div class="col vert-center">
              <img src="{{y['logo_url']}}" class="img-fluid">
            </div>
            <div class="col">
              <p>{{y['name']}}, {{x.coin}}</p>
              <p>Amount Owned: {{x.amount}}</p>
            </div>
            <div class="col">
              <p>Current Price: ${{((y['price'])|float)|round(2)}} USD</p>
              <p>Purchase Price: ${{x.price_pur}} USD</p>
            </div>
            <div class="col vert-center">
              <p>Profit: ${{(((y['price'])|float) - (x.amount*x.price_pur))|round(2)}} USD</p>
            </div>
        {% endif %}
      {% endfor %}
    </div>
    <hr style="height:1px;border-width:0;color:gray;background-color:black;opacity:0.7;">
    {% endfor %}
  </div>
</div> -->


{% endblock %}



<!-- <hr style="height:1px;border-width:0;color:gray;background-color:black;opacity:0.7;"> -->
